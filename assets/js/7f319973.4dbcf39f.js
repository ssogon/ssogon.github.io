"use strict";(self.webpackChunkmatdomabaem_blog=self.webpackChunkmatdomabaem_blog||[]).push([[4287],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return k}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),m=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=m(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=m(n),k=r,d=u["".concat(p,".").concat(k)]||u[k]||c[k]||i;return n?a.createElement(d,o(o({ref:t},s),{},{components:n})):a.createElement(d,o({ref:t},s))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var m=2;m<i;m++)o[m]=n[m];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},84478:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return p},default:function(){return k},frontMatter:function(){return l},metadata:function(){return m},toc:function(){return c}});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],l={title:"HikariCP\uc758 max-lifetime\uc5d0 \ub300\ud558\uc5ec",tags:["java","spring-boot","hikari-cp","postgre-sql"]},p=void 0,m={permalink:"/blog/2022/02/12/HikariCP\uc758-max-lifetime\uc5d0-\ub300\ud558\uc5ec",source:"@site/blog\\2022-02-12-HikariCP\uc758-max-lifetime\uc5d0-\ub300\ud558\uc5ec\\index.md",title:"HikariCP\uc758 max-lifetime\uc5d0 \ub300\ud558\uc5ec",description:"\uc2a4\ud504\ub9c1 \ubd80\ud2b8 \uae30\ubc18 \ud504\ub85c\uc81d\ud2b8\uc5d0\uc11c \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucffc\ub9ac\uc2dc \uac04\ud608\uc801\uc73c\ub85c \uc2e4\ud328\ud558\ub294 \uc774\uc288\uac00 \uc788\uc5c8\ub2e4.",date:"2022-02-12T00:00:00.000Z",formattedDate:"February 12, 2022",tags:[{label:"java",permalink:"/blog/tags/java"},{label:"spring-boot",permalink:"/blog/tags/spring-boot"},{label:"hikari-cp",permalink:"/blog/tags/hikari-cp"},{label:"postgre-sql",permalink:"/blog/tags/postgre-sql"}],readingTime:3.64,truncated:!0,authors:[],frontMatter:{title:"HikariCP\uc758 max-lifetime\uc5d0 \ub300\ud558\uc5ec",tags:["java","spring-boot","hikari-cp","postgre-sql"]},prevItem:{title:"\uc2a4\ud504\ub9c1 \ubd80\ud2b8 JavaFX \uc5b4\ud50c\ub9ac\ucf00\uc774\uc158 \ucd08\uae30 \uc124\uc815",permalink:"/blog/2022/02/13/\uc2a4\ud504\ub9c1-\ubd80\ud2b8-JavaFX-\uc5b4\ud50c\ub9ac\ucf00\uc774\uc158-\ucd08\uae30-\uc124\uc815"},nextItem:{title:"Puppeteer\ub97c \uc774\uc6a9\ud55c \ubc88\uc5ed\uae30 \ud06c\ub864\ub9c1 \uc608\uc81c",permalink:"/blog/2022/01/17/Puppeteer\ub97c-\uc774\uc6a9\ud55c-\ubc88\uc5ed\uae30-\ud06c\ub864\ub9c1-\uc608\uc81c"}},s={authorsImageUrls:[]},c=[],u={toc:c};function k(e){var t=e.components,l=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"\uc2a4\ud504\ub9c1 \ubd80\ud2b8 \uae30\ubc18 \ud504\ub85c\uc81d\ud2b8\uc5d0\uc11c \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucffc\ub9ac\uc2dc \uac04\ud608\uc801\uc73c\ub85c \uc2e4\ud328\ud558\ub294 \uc774\uc288\uac00 \uc788\uc5c8\ub2e4.\n",(0,i.kt)("strong",{parentName:"p"},'"HikariPool-1 - Failed to validate connection org.postgresql.jdbc.PgConnection@6fb43218 (This connection has been Closed). Possibly consider using a shorter maxLifetime value."'),(0,i.kt)("br",{parentName:"p"}),"\n","\uc774\ub294 \uc2a4\ud504\ub9c1 \ubd80\ud2b8 2.0\ubd80\ud130 \uae30\ubcf8 connection \ud480\ub85c \uc124\uc815\ub418\ub294 HikariCP\uc5d0\uc11c \ucd9c\ub825\ud558\ub294 \uc5d0\ub7ec \ub85c\uadf8\ub85c, ",(0,i.kt)("inlineCode",{parentName:"p"},"maxLifetime")," \uac12\uc744 \ub354 \uc9e7\uac8c \uc870\uc815\ud560 \uac83\uc744 \uad8c\ud558\ub294 \ub0b4\uc6a9\uc774\ub2e4."),(0,i.kt)("p",null,"\uc6b0\uc120 ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/brettwooldridge/HikariCP/blob/dev/README.md#frequently-used"},"HikariCP\uc758 README.md"),"\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"maxLifetime")," \ud504\ub85c\ud37c\ud2f0\uc5d0 \ub300\ud574 \uc54c\uc544\ubd24\ub2e4."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"maxLifeTime")," \ud504\ub85c\ud37c\ud2f0\ub294 connection \ud480\uc5d0 \uc788\ub294 connection\ub4e4\uc758 \uc218\uba85\uc744 \ub098\ud0c0\ub0b8\ub2e4."),(0,i.kt)("br",{parentName:"p"}),"\n","\uc0ac\uc6a9 \uc911\uc778 connection\uc740 \uc808\ub300 \ud480\uc5d0\uc11c \uc81c\uac70\ub418\uc9c0 \uc54a\uc73c\uba70, \ud574\ub2f9 connection\uc774 \ub2eb\ud790 \ub54c\ub9cc \uc81c\uac70\ub41c\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\ud480\uc5d0\uc11c connection\uc774 \ud55c\uaebc\ubc88\uc5d0 \uc81c\uac70\ub418\ub294 \uac83\uc744 \ubc29\uc9c0\ud558\uae30 \uc704\ud574 ",(0,i.kt)("inlineCode",{parentName:"p"},"maxLifetime"),"\uc740 connection\ub9c8\ub2e4 \ubcc4\ub3c4\uc758 \uc74c\uc758 \uac10\uc1e0(",(0,i.kt)("em",{parentName:"p"},"negative attenuation"),")\uac00 \uc801\uc6a9\ub41c\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"maxLifetime")," \uac12\uc740 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub610\ub294 \uc778\ud504\ub77c\uc5d0 \uc124\uc815\ub418\uc5b4 \uc788\ub294 connection \uc218\uba85\ubcf4\ub2e4 \uba87 \ucd08 \uc815\ub3c4 \uc9e7\uac8c \uc124\uc815\ud560 \uac83\uc744 \uad8c\uc7a5\ud55c\ub2e4."),(0,i.kt)("br",{parentName:"p"}),"\n","\ub9cc\uc57d \uc774 \uac12\uc744 0\uc73c\ub85c \uc124\uc815\ud55c\ub2e4\uba74 connection\uc758 \uc218\uba85\uc774 \ubb34\ud55c\uc73c\ub85c \uc124\uc815\ub41c\ub2e4. (",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"em"},"idleTimeout"),"\uc774 \uc124\uc815\ub418\uc5b4 \uc788\uc744 \uacbd\uc6b0\ub294 \uc608\uc678"),")",(0,i.kt)("br",{parentName:"p"}),"\n","\ucd5c\uc18c \uac12\uc740 30000ms (",(0,i.kt)("em",{parentName:"p"},"30\ucd08"),")\uace0, \uae30\ubcf8 \uac12\uc740 1800000ms (",(0,i.kt)("em",{parentName:"p"},"30\ubd84"),")\uc774\ub2e4.")),(0,i.kt)("p",null,"\uc704 \uc124\uba85\uc744 \uc77d\uc5b4\ubcf4\ub2c8 \ub370\uc774\ud130\ubca0\uc774\uc2a4\ucabd\uc758 timeout \uad00\ub828 \uc124\uc815\ub4e4\ub3c4 \ud655\uc778\ud560 \ud544\uc694\uac00 \uc788\uc5b4\ubcf4\uc778\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uc544\ub798 \ucffc\ub9ac\ub97c \uc2e4\ud589\ud574\ubcf4\uc790. (",(0,i.kt)("em",{parentName:"p"},"PostgreSQL 11.12 \ud658\uacbd\uc5d0\uc11c \uc9c4\ud589\ud588\ub2e4."),")"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    name, setting, unit, short_desc\nFROM\n    pg_settings\nWHERE\n    name LIKE '%timeout%';\n")),(0,i.kt)("p",null,"\ub2e4\uc74c\uc740 \ucffc\ub9ac \uc218\ud589 \uacb0\uacfc\uc758 \uc77c\ubd80\ub2e4."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"name"),(0,i.kt)("th",{parentName:"tr",align:"left"},"setting"),(0,i.kt)("th",{parentName:"tr",align:"left"},"unit"),(0,i.kt)("th",{parentName:"tr",align:"left"},"short_desc"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"idle_in_transaction_session_timeout"),(0,i.kt)("td",{parentName:"tr",align:"left"},"600000"),(0,i.kt)("td",{parentName:"tr",align:"left"},"ms"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the maximum allowed duration of any idling transaction.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"lock_timeout"),(0,i.kt)("td",{parentName:"tr",align:"left"},"0"),(0,i.kt)("td",{parentName:"tr",align:"left"},"ms"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the maximum allowed duration of any wait for a lock.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"statement_timeout"),(0,i.kt)("td",{parentName:"tr",align:"left"},"0"),(0,i.kt)("td",{parentName:"tr",align:"left"},"ms"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the maximum allowed duration of any statement.")))),(0,i.kt)("p",null,"\uc5ec\uae30\uc11c \uc8fc\ubaa9\ud574\uc57c \ud560 \uc124\uc815 \uac12\uc740 \uc720\ud734(",(0,i.kt)("em",{parentName:"p"},"idle"),") \uc0c1\ud0dc \ud2b8\ub79c\uc7ad\uc158\uc758 \uc218\uba85\uc744 \ub098\ud0c0\ub0b4\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"idle_in_transaction_session_timeout")," \uac12\uc774\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\ud574\ub2f9 \uac12\uc774 600000ms (",(0,i.kt)("em",{parentName:"p"},"10\ubd84"),")\uc73c\ub85c \uc124\uc815\ub418\uc5b4 \uc788\ub294\ub370 HikariCP\uc758 ",(0,i.kt)("inlineCode",{parentName:"p"},"maxLifetime"),"\uc740 \uae30\ubcf8 \uac12\uc778 1800000ms (",(0,i.kt)("em",{parentName:"p"},"30\ubd84"),")\uc73c\ub85c \uc124\uc815\ub418\uc5b4 \uc788\ub358\uac8c \uc77c\uc758 \ubc1c\ub2e8\uc774\uc5c8\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uc774\ubbf8 \ub04a\uc5b4\uc9c4 connection\uc774 HikariCP \ud480\uc5d0 \ub0a8\uc544 \uc788\ub2e4\uac00 \ucc38\uc870\ub418\ub2c8 \ubb38\uc81c\uac00 \ud130\uc9c4 \uac83\uc774\ub2e4."),(0,i.kt)("p",null,"HikariCP\ub97c \ub9cc\ub4e0 Brett Wooldridge\uc758 \ucf54\uba58\ud2b8\uc5d0 \ub530\ub974\uba74 ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"maxLifetime"),"\uc740 \ub370\uc774\ud130\ubca0\uc774\uc2a4 timeout \uc124\uc815\ubcf4\ub2e4 2-3\ucd08 \uc815\ub3c4\ub9cc \ube60\ub974\uac8c \uc8fc\uba74 \ucda9\ubd84\ud558\ub2e4"),"\uace0 \ud55c\ub2e4."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/brettwooldridge/HikariCP/issues/709#issuecomment-384252344"},"https://github.com/brettwooldridge/HikariCP/issues/709#issuecomment-384252344"))),(0,i.kt)("p",null,"\uc774\ub97c \ub530\ub77c ",(0,i.kt)("inlineCode",{parentName:"p"},"application.yml"),"\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"spring.datasource.hikari.max-lifetime")," \uac12\uc744 597000ms (",(0,i.kt)("em",{parentName:"p"},"9\ubd84 57\ucd08"),")\ub85c \uc124\uc815\ud574\uc8fc\ub2c8 \ub354 \uc774\uc0c1 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\uc558\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml",metastring:"{11}","{11}":!0},"spring:\n  config:\n    activate:\n      on-profile: dev\n  datasource:\n    url: ...\n    username: ...\n    password: ...\n    driver-class-name: org.postgresql.Driver\n    hikari:\n      max-lifetime: 597000\n  jpa:\n    database-platform: org.hibernate.dialect.PostgreSQL10Dialect\n")),(0,i.kt)("hr",null),(0,i.kt)("p",null,"\uc5ec\ub2f4\uc73c\ub85c Brett Wooldridge\uc758 \uae43\ud5c8\ube0c \ud504\ub85c\ud544 \uc0ac\uc9c4\uc5d0 \uc77c\ubcf8\uc778 \uc544\ub0b4\uc640 \ub538\uc774 \uc788\uae38\ub798 'Hikari'\uac00 \uac00\uc871 \uc774\ub984\uc778 \uc904 \uc54c\uc558\ub294\ub370 \uadf8\ub0e5 \ube5b\u2728\ucc98\ub7fc \ube60\ub974\ub2e4\ub294 \ub73b\uc73c\ub85c \uc37c\ub2e4\uace0 \ud55c\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(72475).Z,width:"244",height:"244"})),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("a",{parentName:"p",href:"https://blog.jooq.org/jooq-tuesdays-brett-wooldridge-shows-what-it-takes-to-write-the-fastest-java-connection-pool/"},"https://blog.jooq.org/jooq-tuesdays-brett-wooldridge-shows-what-it-takes-to-write-the-fastest-java-connection-pool/"))))}k.isMDXComponent=!0},72475:function(e,t,n){t.Z=n.p+"assets/images/brett-wooldridge-dd2951a5650779f9c808137a825d53ca.png"}}]);